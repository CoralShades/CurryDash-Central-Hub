---
generated: "2026-02-18"
source: "BMAD v6 planning artifacts"
project: "CurryDash-Central-Hub"
total_stories: 36
total_epics: 8
---

# Ralph Implementation Plan

Generated from BMAD v6 planning artifacts on 2026-02-18.

## Architecture Context

CurryDash Central Hub is a role-based project management portal built on Next.js 15 (App Router) with Supabase as the unified backend providing PostgreSQL, Auth, Realtime subscriptions, and Row-Level Security (RLS). Authentication uses Auth.js v5 with SupabaseAdapter, issuing stateless JWTs with role claims that enable three-layer RBAC enforcement: Edge Middleware for route gating, Server Components via an `auth()` helper for data-level checks, and Supabase RLS policies at the database layer. The UI is styled with Tailwind CSS v4 and shadcn/ui (stone base overridden with a spice-themed palette), featuring a config-driven widget grid where each widget is self-contained with its own error boundary, data fetching, and loading skeleton.

The AI layer uses CopilotKit on the frontend (`CopilotSidebar`) connected to a Mastra agent backend (`src/mastra/`) via the AG-UI protocol, with MCP servers providing live Jira and GitHub data queries. Model routing sends simple queries to Claude Haiku and complex reports to Claude Sonnet, with per-request (4,000 tokens) and per-session (8,000 tokens) budgets enforced. External data flows through a shared webhook pipeline pattern: HMAC-SHA256 validation, event ID deduplication, Zod parsing, Supabase upsert, ISR `revalidateTag()` cache invalidation, and Realtime broadcast to connected clients, with dead letter logging for any failures.

The codebase follows a feature module structure at `src/modules/{feature}/` with components, hooks, actions, types, and co-located tests. Shared UI lives in `src/components/`, utilities in `src/lib/`, and Zustand stores (UI state only) in `src/stores/`. Testing uses Vitest for unit/integration tests and Playwright for E2E, with CI via GitHub Actions and deployment on Vercel.

## Tech Stack Summary

- Frontend: Next.js 15 (App Router), React 18, TypeScript strict
- Styling: Tailwind CSS v4, shadcn/ui (stone base + spice overrides)
- Database: Supabase (PostgreSQL + RLS + Realtime)
- Auth: Auth.js v5 with SupabaseAdapter, JWT role claims
- AI: CopilotKit frontend, Mastra backend, MCP servers (Jira, GitHub)
- Testing: Vitest (unit/integration), Playwright (E2E)
- Deployment: Vercel, GitHub Actions CI

## Epic Dependency Chain

Epic 1 (Foundation) → Epic 2 (Auth) → Epic 3 (Dashboard Shell)
                                        ├→ Epic 4 (Jira) [parallel]
                                        ├→ Epic 5 (GitHub) [parallel]
                                        └→ Epic 8 (Admin) [parallel]
                                                           ├→ Epic 6 (AI Assistant)
                                                           └→ Epic 7 (AI Reports)

## Stories

### [EPIC-1] Story 1.1: Project Scaffold & Dependency Installation
- **Status:** [x] done
- **Epic:** Project Foundation & Design System
- **FRs:** Foundational (ARCH-1, ARCH-2, ARCH-18)
- **Dependencies:** none
- **Estimated Complexity:** moderate
- **Recommended Model:** sonnet
- **Key Files:**
  - `package.json` (all core + dev dependencies)
  - `tsconfig.json` (strict mode, `@/` alias)
  - `src/app/` directory structure
  - `src/components/`, `src/modules/`, `src/lib/`, `src/stores/`, `src/types/`, `src/test-utils/`, `src/mastra/`
  - `.env.example` (all env var placeholders)
  - `components.json` (shadcn/ui config with stone base)

### [EPIC-1] Story 1.2: Supabase Database Schema & Migrations
- **Status:** [x] done
- **Epic:** Project Foundation & Design System
- **FRs:** Foundational (ARCH-3, ARCH-7)
- **Dependencies:** 1.1
- **Estimated Complexity:** moderate
- **Recommended Model:** haiku
- **Key Files:**
  - `supabase/migrations/` (DDL for all tables)
  - `supabase/seed.sql` (4 default roles + test admin user)
  - Tables: `roles`, `users`, `teams`, `team_members`, `jira_projects`, `jira_sprints`, `jira_issues`, `github_repos`, `github_pull_requests`, `webhook_events`, `dead_letter_events`, `dashboard_widgets`, `notifications`, `ai_chat_sessions`, `system_health`

### [EPIC-1] Story 1.3: Spice Palette Design System & Theme Configuration
- **Status:** [x] done
- **Epic:** Project Foundation & Design System
- **FRs:** Foundational (ARCH-10, UX-5, UX-15)
- **Dependencies:** 1.1
- **Estimated Complexity:** simple
- **Recommended Model:** haiku
- **Key Files:**
  - `src/app/globals.css` (CSS custom properties: brand, semantic, status, role badge colors; typography scale; spacing scale; shadows; border radius; animation tokens)
  - `tailwind.config.ts` (spice palette integration)
  - Role-specific theming via `data-role` attribute on `<body>`

### [EPIC-1] Story 1.4: Shared UI Components & Error Handling Infrastructure
- **Status:** [x] done
- **Epic:** Project Foundation & Design System
- **FRs:** Foundational (ARCH-8, UX-10, UX-11, UX-12)
- **Dependencies:** 1.1, 1.3
- **Estimated Complexity:** moderate
- **Recommended Model:** haiku
- **Key Files:**
  - `src/components/shared/widget-skeleton.tsx` (`<WidgetSkeleton variant="chart|table|stats|list" />`)
  - `src/components/shared/widget-error.tsx` (`<WidgetError />`)
  - `src/components/shared/error-boundary.tsx` (`<ErrorBoundary>`)
  - `src/components/shared/staleness-indicator.tsx` (`<StalenessIndicator>`)
  - `src/components/shared/role-gate.tsx` (`<RoleGate>`)
  - `src/components/shared/relative-time.tsx` (`<RelativeTime>`)
  - `src/lib/errors.ts` (`AppError`, `AuthError`, `IntegrationError`, `ValidationError`, `RateLimitError`)
  - `src/lib/logger.ts` (structured JSON logger)
  - `src/lib/constants.ts` (app-wide constants)

### [EPIC-1] Story 1.5: Zustand Stores & Client State Infrastructure
- **Status:** [x] done
- **Epic:** Project Foundation & Design System
- **FRs:** Foundational (ARCH-11)
- **Dependencies:** 1.1
- **Estimated Complexity:** simple
- **Recommended Model:** haiku
- **Key Files:**
  - `src/stores/use-dashboard-store.ts` (`useDashboardStore`)
  - `src/stores/use-filter-store.ts` (`useFilterStore`)
  - `src/stores/use-sidebar-store.ts` (`useSidebarStore`)
  - `src/types/roles.ts` (`Role` enum, `RolePermissions` type)
  - `src/types/api.ts` (`ApiResponse<T>`, `ApiError`)
  - `src/types/database.ts` (Supabase generated types placeholder)

### [EPIC-2] Story 2.1: Auth.js Configuration & Login Page
- **Status:** [x] done
- **Epic:** Identity & Access Management
- **FRs:** FR1, FR2
- **Dependencies:** 1.1, 1.2, 1.3
- **Estimated Complexity:** complex
- **Recommended Model:** sonnet
- **Key Files:**
  - `src/app/(auth)/login/page.tsx` (centered login card)
  - `src/lib/auth.ts` (Auth.js v5 config with SupabaseAdapter)
  - `src/app/api/auth/[...nextauth]/route.ts` (Auth.js route handler)
  - JWT callback injecting `role` claim

### [EPIC-2] Story 2.2: Session Management & Security Hardening
- **Status:** [x] done
- **Epic:** Identity & Access Management
- **FRs:** FR2 (NFR-S1, NFR-S2, NFR-S9, NFR-S10)
- **Dependencies:** 2.1
- **Estimated Complexity:** complex
- **Recommended Model:** sonnet
- **Key Files:**
  - `src/lib/supabase/client.ts` (browser Client Components)
  - `src/lib/supabase/server.ts` (Server Components, read-only)
  - `src/lib/supabase/middleware.ts` (cookie refresh)
  - `src/lib/supabase/admin.ts` (service role, bypasses RLS)
  - Session expiry / sliding refresh / CSRF / HSTS configuration

### [EPIC-2] Story 2.3: Edge Middleware & Route-Level RBAC
- **Status:** [x] done
- **Epic:** Identity & Access Management
- **FRs:** FR3, FR8, FR9
- **Dependencies:** 2.1
- **Estimated Complexity:** moderate
- **Recommended Model:** sonnet
- **Key Files:**
  - `src/middleware.ts` (Edge Middleware: JWT role extraction, route-to-role mapping, cookie refresh)
  - Route protection: `/admin/*`, `/dev/*`, `/qa/*`, `/stakeholder/*`
  - Public routes: `/login`, `/register`, `/api/webhooks/*`

### [EPIC-2] Story 2.4: Server-Side Authorization & Supabase RLS Policies
- **Status:** [x] done
- **Epic:** Identity & Access Management
- **FRs:** FR4, FR5 (NFR-S3, NFR-S6, NFR-S7, NFR-S8)
- **Dependencies:** 2.1, 1.2
- **Estimated Complexity:** complex
- **Recommended Model:** sonnet
- **Key Files:**
  - `src/lib/auth.ts` (`auth()` helper for Server Components)
  - `supabase/migrations/` (RLS policies on every table: admin full access, developer project + own, QA project + QA records, stakeholder read-only aggregate)
  - Policies use `auth.jwt()->>'role'`

### [EPIC-2] Story 2.5: Admin User Management Page
- **Status:** [x] done
- **Epic:** Identity & Access Management
- **FRs:** FR6, FR7
- **Dependencies:** 2.1, 2.3, 2.4
- **Estimated Complexity:** moderate
- **Recommended Model:** haiku
- **Key Files:**
  - `src/app/(dashboard)/admin/users/page.tsx` (thin Server Component wrapper)
  - `src/modules/admin/components/user-table.tsx` (data table with sort/filter/pagination)
  - `src/modules/admin/components/user-form-modal.tsx` (add/edit user dialog)
  - `src/modules/admin/actions/manage-users.ts` (Server Actions: createUser, updateUser, deactivateUser)
  - `src/modules/admin/schemas/user-schema.ts` (Zod validation)

### [EPIC-3] Story 3.1: Dashboard Layout Shell & Sidebar Navigation
- **Status:** [x] done
- **Epic:** Dashboard Shell & Data Visualization
- **FRs:** FR10 (UX-1, UX-2, UX-13, UX-16)
- **Dependencies:** 2.3, 1.3, 1.4
- **Estimated Complexity:** moderate
- **Recommended Model:** sonnet
- **Key Files:**
  - `src/app/(dashboard)/layout.tsx` (sidebar + header shell)
  - `src/modules/dashboard/components/sidebar.tsx` (256px/64px collapsible, role-conditional sections)
  - `src/modules/dashboard/components/page-header.tsx` (title, freshness, alerts badge, AI toggle, user menu)
  - Keyboard shortcuts: `[` sidebar, `Cmd+K` AI, `G then D/U/I/S` nav, `Escape` close

### [EPIC-3] Story 3.2: Widget Grid & Config-Driven Rendering
- **Status:** [ ] pending
- **Epic:** Dashboard Shell & Data Visualization
- **FRs:** FR10, FR19 (ARCH-6, NFR-P1, NFR-P2, NFR-R2)
- **Dependencies:** 3.1, 1.4
- **Estimated Complexity:** moderate
- **Recommended Model:** sonnet
- **Key Files:**
  - `src/modules/dashboard/config/widget-registry.ts` (role → widget[] config)
  - `src/modules/dashboard/components/widget-grid.tsx` (12-column CSS Grid, 24px gap, 1440px max)
  - `src/modules/dashboard/components/widget-card.tsx` (white surface, shadow, ErrorBoundary wrapping)
  - `src/app/(dashboard)/admin/page.tsx`, `dev/page.tsx`, `qa/page.tsx`, `stakeholder/page.tsx` (thin wrappers)

### [EPIC-3] Story 3.3: Key Metric Cards & Team Activity Feed
- **Status:** [ ] pending
- **Epic:** Dashboard Shell & Data Visualization
- **FRs:** FR13, FR14 (NFR-P3)
- **Dependencies:** 3.2
- **Estimated Complexity:** moderate
- **Recommended Model:** haiku
- **Key Files:**
  - `src/modules/dashboard/components/metric-card.tsx` (label, value, trend, sparkline)
  - `src/modules/dashboard/components/activity-feed.tsx` (chronological event list, 10 items, aria-live)
  - 4 default metric cards: Stories Completed, PRs Merged, Bugs Open, CI Status

### [EPIC-3] Story 3.4: Blocker Indicators & Drill-Down Detail Views
- **Status:** [ ] pending
- **Epic:** Dashboard Shell & Data Visualization
- **FRs:** FR15, FR16, FR18
- **Dependencies:** 3.2
- **Estimated Complexity:** moderate
- **Recommended Model:** haiku
- **Key Files:**
  - `src/modules/dashboard/components/blocker-card.tsx` (priority-sorted blockers, Chili Red accent)
  - `src/modules/dashboard/components/detail-panel.tsx` (Jira issue detail, PR detail, breadcrumbs)
  - Staleness badges (amber >10min, red >30min)

### [EPIC-3] Story 3.5: Stakeholder Dashboard Variant & Responsive Behavior
- **Status:** [ ] pending
- **Epic:** Dashboard Shell & Data Visualization
- **FRs:** FR17 (UX-9, UX-14)
- **Dependencies:** 3.1, 3.2
- **Estimated Complexity:** moderate
- **Recommended Model:** sonnet
- **Key Files:**
  - `src/app/(dashboard)/stakeholder/page.tsx` (stakeholder-specific widget config)
  - `src/modules/dashboard/config/widget-registry.ts` (stakeholder role entry: aggregate-only, no admin controls)
  - Responsive breakpoints: 1440px+ (3-col), 1280px+ (3-col), 1024px+ (2-col, sidebar collapses), 768px+ (tablet), <768px (mobile message)

### [EPIC-4] Story 4.1: Jira API Client & Authenticated Data Fetching
- **Status:** [x] done
- **Epic:** Jira Integration & Live Sprint Data
- **FRs:** FR20, FR21, FR25, FR45
- **Dependencies:** 1.2, 1.4
- **Estimated Complexity:** moderate
- **Recommended Model:** sonnet
- **Key Files:**
  - `src/lib/clients/jira-client.ts` (Jira Cloud REST API v3 client)
  - `src/types/jira.ts` (`JiraIssue`, `JiraSprint`, `JiraEpic`, `JiraProject`, `JiraWebhookEvent`)
  - Rate limit handling: exponential backoff 1s/2s/4s/8s, max 4 retries
  - Supabase admin client upserts for cached data

### [EPIC-4] Story 4.2: Jira Webhook Receiver & Validation Pipeline
- **Status:** [ ] pending
- **Epic:** Jira Integration & Live Sprint Data
- **FRs:** FR22, FR23, FR46, FR47, FR48, FR50 (ARCH-7, ARCH-9, ARCH-14, NFR-S5)
- **Dependencies:** 4.1, 1.4
- **Estimated Complexity:** complex
- **Recommended Model:** sonnet
- **Key Files:**
  - `src/app/api/webhooks/jira/route.ts` (Route Handler: HMAC validate → dedup → Zod parse → upsert → revalidateTag → broadcast → 200)
  - `src/lib/schemas/jira-webhook-schema.ts` (`jiraWebhookEventSchema`, `jiraIssuePayloadSchema`)
  - `dead_letter_events` table writes on validation/processing failure
  - Correlation ID generation per event

### [EPIC-4] Story 4.3: Webhook Idempotency, Event Ordering & Burst Handling
- **Status:** [ ] pending
- **Epic:** Jira Integration & Live Sprint Data
- **FRs:** FR48, FR49, FR50 (NFR-I1, NFR-I2, NFR-R4, NFR-R7, NFR-SC4)
- **Dependencies:** 4.2
- **Estimated Complexity:** complex
- **Recommended Model:** sonnet
- **Key Files:**
  - `src/app/api/webhooks/jira/route.ts` (enhanced dedup, timestamp comparison, retry logic)
  - `webhook_events` table (event ID dedup check-before-process)
  - `dead_letter_events` table (overflow + exhausted retries)
  - Retry: 1s/5s/30s exponential backoff, max 3 retries

### [EPIC-4] Story 4.4: Sprint Progress Dashboard Widget & Cache Revalidation
- **Status:** [ ] pending
- **Epic:** Jira Integration & Live Sprint Data
- **FRs:** FR11, FR21, FR46, FR47 (ARCH-9)
- **Dependencies:** 4.1, 3.2
- **Estimated Complexity:** moderate
- **Recommended Model:** haiku
- **Key Files:**
  - `src/modules/jira/components/sprint-progress-widget.tsx` (6-col card, per-project progress bars)
  - `src/modules/jira/components/sprint-detail-view.tsx` (drill-down: issues grouped by status)
  - ISR revalidation via `revalidateTag('issues')` + Realtime broadcast

### [EPIC-4] Story 4.5: Jira Webhook Auto-Refresh & Integration Resilience
- **Status:** [ ] pending
- **Epic:** Jira Integration & Live Sprint Data
- **FRs:** FR24, FR50 (NFR-I8)
- **Dependencies:** 4.2, 4.3
- **Estimated Complexity:** moderate
- **Recommended Model:** sonnet
- **Key Files:**
  - `src/app/api/cron/refresh-webhooks/route.ts` (secured by `CRON_SECRET`, 25-day cycle)
  - Supabase admin client for webhook re-registration
  - `dead_letter_events` on refresh failure
  - Integration failure isolation (Jira down does not affect GitHub or AI)

### [EPIC-5] Story 5.1: GitHub API Client & Repository Data Fetching
- **Status:** [x] done
- **Epic:** GitHub Integration & Repository Activity
- **FRs:** FR26, FR27, FR45 (NFR-I5)
- **Dependencies:** 1.2, 1.4
- **Estimated Complexity:** moderate
- **Recommended Model:** sonnet
- **Key Files:**
  - `src/lib/clients/github-client.ts` (Octokit SDK, OAuth token auth)
  - `src/types/github.ts` (`GitHubRepo`, `PullRequest`, `CommitActivity`, `WorkflowRun`, `GitHubWebhookEvent`)
  - `src/modules/github/actions/sync-repos.ts` (Server Action for manual sync)
  - Rate limit tracking via `X-RateLimit-Remaining` header, exponential backoff

### [EPIC-5] Story 5.2: GitHub Webhook Receiver & Validation Pipeline
- **Status:** [ ] pending
- **Epic:** GitHub Integration & Repository Activity
- **FRs:** FR28, FR29, FR46, FR47, FR50 (ARCH-14, NFR-S4, NFR-P8)
- **Dependencies:** 5.1, 1.4
- **Estimated Complexity:** complex
- **Recommended Model:** sonnet
- **Key Files:**
  - `src/app/api/webhooks/github/route.ts` (Route Handler: HMAC-SHA256 via `X-Hub-Signature-256` → dedup → Zod parse → upsert → revalidateTag → broadcast → 200)
  - `src/lib/schemas/github-webhook-schema.ts` (`githubWebhookEventSchema`, `githubPushPayloadSchema`, `githubPrPayloadSchema`, `githubWorkflowRunPayloadSchema`)
  - Events: `push`, `pull_request`, `workflow_run`
  - `dead_letter_events` on failure

### [EPIC-5] Story 5.3: PR Status & Code Review Dashboard Widget
- **Status:** [ ] pending
- **Epic:** GitHub Integration & Repository Activity
- **FRs:** FR12, FR19
- **Dependencies:** 5.1, 3.2
- **Estimated Complexity:** moderate
- **Recommended Model:** haiku
- **Key Files:**
  - `src/modules/github/components/pr-status-widget.tsx` (6-col card, PR list with review/CI status)
  - `src/modules/github/components/pr-detail-view.tsx` (drill-down: reviewers, CI checks, lines changed)
  - Filter row: Needs Review, Changes Requested, Ready to Merge, All
  - Stakeholder view: titles only, no code links

### [EPIC-5] Story 5.4: CI/CD Pipeline Status & Commit Activity Widget
- **Status:** [ ] pending
- **Epic:** GitHub Integration & Repository Activity
- **FRs:** FR27, FR19 (NFR-P8)
- **Dependencies:** 5.2, 3.2
- **Estimated Complexity:** moderate
- **Recommended Model:** haiku
- **Key Files:**
  - `src/modules/github/components/cicd-status-widget.tsx` (6-col card, workflow runs, summary row)
  - `src/modules/github/components/commit-activity-chart.tsx` (sparkline/bar chart, 14-day commit frequency)
  - ISR via `revalidateTag('github-ci')` + Realtime broadcast

### [EPIC-6] Story 6.1: Mastra AI Backend & Agent Configuration
- **Status:** [ ] pending
- **Epic:** AI Assistant & Project Intelligence
- **FRs:** FR34 (ARCH-12, ARCH-15, ARCH-16)
- **Dependencies:** 1.2, 4.1, 5.1
- **Estimated Complexity:** complex
- **Recommended Model:** sonnet
- **Key Files:**
  - `src/mastra/agents/dashboard-agent.ts` (main CopilotKit-connected agent)
  - `src/mastra/agents/report-agent.ts` (report generation agent)
  - `src/mastra/tools/jira-tools.ts` (Jira query tools)
  - `src/mastra/tools/github-tools.ts` (GitHub query tools)
  - `src/mastra/tools/supabase-tools.ts` (direct DB query tools)
  - Model routing: Haiku (simple) / Sonnet (complex), `maxTokens: 4000`, session cap 8,000
  - `ai_usage` Supabase table for cost tracking

### [EPIC-6] Story 6.2: CopilotKit AI Sidebar & Chat Interface
- **Status:** [ ] pending
- **Epic:** AI Assistant & Project Intelligence
- **FRs:** FR30, FR31 (NFR-P4, NFR-P5, UX-6)
- **Dependencies:** 6.1, 3.1
- **Estimated Complexity:** complex
- **Recommended Model:** sonnet
- **Key Files:**
  - `src/modules/ai/copilot-provider.tsx` (CopilotKit provider + configuration)
  - `src/modules/ai/ai-sidebar.tsx` (CopilotSidebar customization, 400px, slides from right)
  - `src/modules/ai/ai-status.tsx` (AI availability indicator)
  - `src/modules/ai/use-copilot-context.ts` (`useCopilotReadable`)
  - `src/modules/ai/use-copilot-actions.ts` (`useCopilotAction`)
  - `src/app/api/ai/copilotkit/route.ts` (SSE streaming route handler)

### [EPIC-6] Story 6.3: MCP Tool Integration for Live Data Queries
- **Status:** [ ] pending
- **Epic:** AI Assistant & Project Intelligence
- **FRs:** FR32, FR33, FR35 (ARCH-15, NFR-I7)
- **Dependencies:** 6.1, 4.1, 5.1
- **Estimated Complexity:** complex
- **Recommended Model:** sonnet
- **Key Files:**
  - `src/mastra/tools/jira-tools.ts` (MCP Jira queries, 5s timeout → Supabase fallback)
  - `src/mastra/tools/github-tools.ts` (MCP GitHub queries, 5s timeout → Supabase fallback)
  - `src/mastra/tools/supabase-tools.ts` (3s timeout direct DB queries)
  - Source citation logic: "Live query" vs "Cached data as of [timestamp]"
  - Token budget check before each tool invocation (session 8,000 cap)

### [EPIC-6] Story 6.4: Role-Specific AI Behavior & Graceful Degradation
- **Status:** [ ] pending
- **Epic:** AI Assistant & Project Intelligence
- **FRs:** FR34, FR36, FR37 (NFR-R3, NFR-S8)
- **Dependencies:** 6.2, 6.3, 2.4
- **Estimated Complexity:** moderate
- **Recommended Model:** sonnet
- **Key Files:**
  - `src/mastra/agents/dashboard-agent.ts` (role-specific system prompts per JWT role)
  - `src/modules/ai/ai-status.tsx` (`<AiStatus />` indicator for unavailability)
  - Role filtering: Stakeholder (aggregate only), Developer (full technical), QA (testing focus)
  - Dashboard continues fully without AI; AI toggle shows muted state when unavailable

### [EPIC-7] Story 7.1: AI Sprint Status Report Generation
- **Status:** [ ] pending
- **Epic:** AI Reports & Widget Generation
- **FRs:** FR38, FR40, FR35 (NFR-P7)
- **Dependencies:** 6.1, 6.3, 4.1
- **Estimated Complexity:** moderate
- **Recommended Model:** sonnet
- **Key Files:**
  - `src/mastra/agents/report-agent.ts` (sprint report generation via Sonnet)
  - `src/mastra/tools/report-tools.ts` (dedicated report tools)
  - Report output: sprint name/dates, per-project completion, velocity trend, blocker summary, narrative
  - "Data as of [timestamp]" footer, source citations
  - Queued retry on AI provider outage

### [EPIC-7] Story 7.2: AI Stakeholder Progress Summary
- **Status:** [ ] pending
- **Epic:** AI Reports & Widget Generation
- **FRs:** FR39, FR40, FR35, FR34 (NFR-P7)
- **Dependencies:** 7.1, 6.4
- **Estimated Complexity:** moderate
- **Recommended Model:** sonnet
- **Key Files:**
  - `src/mastra/agents/report-agent.ts` (stakeholder summary via Sonnet)
  - Report output: health indicator, milestone %, achievements, risks, outlook
  - No individual developer names, code details, or PR numbers for stakeholders
  - Streaming partial output via SSE (FR31)

### [EPIC-7] Story 7.3: AI Widget Generation via Natural Language
- **Status:** [ ] pending
- **Epic:** AI Reports & Widget Generation
- **FRs:** FR41, FR42, FR19 (NFR-P6, UX-7)
- **Dependencies:** 6.2, 3.2
- **Estimated Complexity:** complex
- **Recommended Model:** sonnet
- **Key Files:**
  - `src/mastra/agents/dashboard-agent.ts` (widget generation via Sonnet)
  - `src/modules/ai/components/widget-preview.tsx` (inline sidebar preview)
  - `src/modules/dashboard/components/ai-widget-renderer.tsx` (metric card, bar/line/pie chart, data table)
  - Widget config: type, data source query, display properties (CSS custom props), grid span, refresh
  - Zod validation before persistence

### [EPIC-7] Story 7.4: Widget Persistence & Pre-Built Fallbacks
- **Status:** [ ] pending
- **Epic:** AI Reports & Widget Generation
- **FRs:** FR43, FR44
- **Dependencies:** 7.3, 1.2
- **Estimated Complexity:** moderate
- **Recommended Model:** haiku
- **Key Files:**
  - `src/modules/dashboard/actions/manage-widgets.ts` (Server Actions: saveWidget, deleteWidget, regenerateWidget)
  - `src/modules/dashboard/config/widget-registry.ts` (pre-built static fallback widgets per role)
  - `dashboard_widgets` Supabase table (user_id, widget_config JSONB, position, role)
  - Widget menu: Remove (soft-delete), Regenerate
  - AI-generated widgets persist and render without AI being online

### [EPIC-8] Story 8.1: Integration Configuration Admin Page
- **Status:** [ ] pending
- **Epic:** System Administration & Observability
- **FRs:** FR51, FR52, FR54 (NFR-S3, NFR-I8)
- **Dependencies:** 2.5, 4.1, 5.1
- **Estimated Complexity:** moderate
- **Recommended Model:** haiku
- **Key Files:**
  - `src/app/(dashboard)/admin/integrations/page.tsx` (admin-only, Server Component wrapper)
  - `src/modules/admin/components/integration-health.tsx` (Jira, GitHub, Anthropic cards with status)
  - `src/modules/admin/components/integration-config-form.tsx` (credential entry with masked hints)
  - `src/modules/admin/actions/configure-integration.ts` (Server Action, Zod validated)
  - Test Connection functionality per integration

### [EPIC-8] Story 8.2: System Health Dashboard & Dead Letter Monitor
- **Status:** [ ] pending
- **Epic:** System Administration & Observability
- **FRs:** FR52, FR50, FR56 (NFR-I1, NFR-I3, NFR-I4, NFR-I5, NFR-I6)
- **Dependencies:** 8.1, 4.2, 5.2
- **Estimated Complexity:** moderate
- **Recommended Model:** sonnet
- **Key Files:**
  - `src/app/(dashboard)/admin/system-health/page.tsx` (admin-only)
  - `src/modules/admin/components/webhook-monitor.tsx` (success rate, latency, dead letter depth)
  - `src/modules/admin/components/dead-letter-table.tsx` (expandable rows: raw payload, stack trace, correlation ID)
  - `src/modules/admin/actions/retry-dead-letter.ts` (retry single + bulk retry)
  - Rate limit section: 429 history, remaining quota, 50% warning banner

### [EPIC-8] Story 8.3: AI Usage Tracking & Cost Dashboard
- **Status:** [ ] pending
- **Epic:** System Administration & Observability
- **FRs:** FR53, FR55
- **Dependencies:** 8.1, 6.1
- **Estimated Complexity:** moderate
- **Recommended Model:** haiku
- **Key Files:**
  - `src/modules/admin/components/ai-cost-tracker.tsx` (monthly spend, budget bar, daily trend, model split)
  - `ai_usage` Supabase table (date, query count, tokens, cost)
  - Budget bar: green <60%, amber 60-80%, red >80%
  - Token cap display: 4,000/request, 8,000/session

### [EPIC-8] Story 8.4: Notification System & Admin Alerting
- **Status:** [ ] pending
- **Epic:** System Administration & Observability
- **FRs:** FR56
- **Dependencies:** 8.1, 3.1
- **Estimated Complexity:** moderate
- **Recommended Model:** sonnet
- **Key Files:**
  - `src/modules/notifications/components/notification-dropdown.tsx` (bell icon dropdown, unread badge)
  - `src/modules/notifications/actions/manage-notifications.ts` (markAsRead, markAllRead)
  - `notifications` Supabase table (linked to user, RLS enforced)
  - Event triggers: webhook failure, dead letter growth, integration disconnect, AI budget 80%, webhook refresh failure, rate limit 50%
  - Realtime push on `dashboard:admin` channel

## Summary

| Metric | Value |
|--------|-------|
| Total Stories | 36 |
| Haiku Stories | 13 |
| Sonnet Stories | 23 |
| Simple | 2 |
| Moderate | 24 |
| Complex | 10 |
